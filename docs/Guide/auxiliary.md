---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

(Guide-Auxiliary)=
# Auxiliary functions

The `Plotter` class also supports the definition of auxiliary curves. These are combination of concentrations of various species in solution and are very useful in the solution of many different acid-base problem. For example, by using auxiliary curves, on can easily visualize the point in which the protonic balance of a given solution is satisfies.

To demonstrate how this can be done, let us consider as an example the problem of computing the $pH$ of a $0.01M$ diammonium phosphate $(NH_4)_2HPO_4$ solution. To do so, let us start by defining the system of acids according to:

```{code-cell} python
from pypH.base import *

phosphoric_acid = Acid([2.14, 7.20, 12.37], 0.01, names=["$H_3PO_4$", "$H_2PO_4^-$", "$HPO_4^{2-}$", "$PO_4^{3-}$"])
ammonium = Acid([9.24], 0.02, names=["$NH_4^+$", "$NH_3$"])
```

That, represented on the logarithmic diagram, appears as follows:

```{code-cell} python
plotter = Plotter()

plotter.add(ammonium)
plotter.add(phosphoric_acid)

plotter.plot(show_legend=True)
```

To solve the problem and compute the $pH$ of the solution, one should consider the protonic balance that, for the system in question is represented by:

$$
    [H_3O^+] + [H_2PO_4^-] + 2[H_3PO_4] = [PO_4^{3-}] + [NH_3] + [OH^-]
$$

To visualze the protonic balance on the logarithmic diagram one should represents both sides of the equality in terms of an `Auxiliary` function object. An auxiliary function object is simply a collection of species in various state of deprotonation corredated by a given coefficient. The `Auxiliary` object or the various `Species` object can be constructed manually by the user, using the informations provided in the API guide, or more conveniently can be automatically generated by the already available `Acid` class objects.

The process is straightforward: given an `Acid` object, the correspondig speces can be obtained by directly using the `[index]` operator and specifying as the `index` the deprotonation degree of the wanted species. The obtained `Species` object can be multiplied by a `float` coefficient and summed to or subtracted from other `Species` of `Auxiliary` object to give the final `Auxiliary` expression. To show how this can be done consider the following example in which the right and left sides of the protonic balance are constructed:

```{code-cell} python
right_side = Hydronium + phosphoric_acid[1] + 2.*phosphoric_acid[0]
left_side = phosphoric_acid[3] + ammonium[1] + Hydroxide
```

Where the `Hydronium` and `Hydroxide` object are pre-defined intances of the `Species` class to represent the solvent derived ions $H_3O^+$ ad $OH^-$.

The auxiliary curves can be added to the plot using the `add_auxiliary` function according to:

```{code-cell} python
plotter.add_auxiliary(right_side)
plotter.add_auxiliary(left_side)

plotter.plot(show_legend=True)
```