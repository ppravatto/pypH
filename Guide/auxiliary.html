

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Species and Auxiliary functions &mdash; pypH User Guide</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=b8108963" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/scripts/sphinx-book-theme.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualizing titration curves" href="titration.html" />
    <link rel="prev" title="Basic usage" href="plotting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../intro.html">
            
              <img src="../_static/logo_pypH.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user-guide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Basic usage</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Species and Auxiliary functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="titration.html">Visualizing titration curves</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributor-guide.html">Contributor’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../intro.html">Project name not set</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../intro.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../user-guide.html">User guide</a></li>
      <li class="breadcrumb-item active">Species and Auxiliary functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Guide/auxiliary.md" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="plotting.html" class="btn btn-neutral float-left" title="Basic usage" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="titration.html" class="btn btn-neutral float-right" title="Visualizing titration curves" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="species-and-auxiliary-functions">
<span id="guide-auxiliary"></span><h1>Species and Auxiliary functions<a class="headerlink" href="#species-and-auxiliary-functions" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">System</span></code> class also supports the definition of auxiliary curves. These are combination of concentrations of various species in solution and are very useful in the solution of many different acid-base problem. For example, by using auxiliary curves, one can easily visualize the point in which the protonic balance of a given solution is satisfied. To do so, however, we must discuss how simbolic expression can be constructed in the <code class="docutils literal notranslate"><span class="pre">pypH</span></code> environment.</p>
<section id="the-species-objects-logic">
<h2>The <code class="docutils literal notranslate"><span class="pre">Species</span></code> objects logic<a class="headerlink" href="#the-species-objects-logic" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pypH</span></code> library has been developed with the logic of providing the user with an almost pen an paper experience in which expressions involving concentrations of species in solution can be treated directly in an algebric expression.</p>
<p>What you have seen so far in the <a class="reference internal" href="plotting.html#guide-basic"><span class="std std-ref">basic plotting tutorial</span></a> was the definition of an generic <code class="docutils literal notranslate"><span class="pre">Acid</span></code> system that takes into account all its possible deprotonation states and can be used to model its behavior in solution. This operation sets the concentration of the acid and it’s <span class="math notranslate nohighlight">\(pKa\)</span> allowing the generation of its logarithmic diagram.</p>
<p>If, however, we want to write a symbolic expression involving, for example, the concentration of a given deprotonation state, we must find an univocal way of referring to a given species derived from the acid deprotonation. This, in the <code class="docutils literal notranslate"><span class="pre">pypH</span></code> environment can be done using the <code class="docutils literal notranslate"><span class="pre">Species</span></code> class and it’s derived subclasses <code class="docutils literal notranslate"><span class="pre">AcidSpecies</span></code> and <code class="docutils literal notranslate"><span class="pre">SpectatorSpecies</span></code> objects.</p>
<p>To obtain the symbolic representation of a given species it is sufficient to operate using the <code class="docutils literal notranslate"><span class="pre">()</span></code> round bracket operator on the base <code class="docutils literal notranslate"><span class="pre">Acid</span></code> or <code class="docutils literal notranslate"><span class="pre">Spectator</span></code> class. As an example, referring to the oxalic acid case presented before, the reference to the mono-acid oxalate ion can be obtained from the <code class="docutils literal notranslate"><span class="pre">Acid</span></code> object by specifying the deprotonation index <code class="docutils literal notranslate"><span class="pre">(1)</span></code> of the species:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pypH.acid</span><span class="w"> </span><span class="kn">import</span> <span class="n">Acid</span>

<span class="n">oxalic_acid</span> <span class="o">=</span> <span class="n">Acid</span><span class="p">([</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">4.14</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">HOx_species</span> <span class="o">=</span> <span class="n">oxalic_acid</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">HOx_species</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">HOx_species</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pypH.acid</span><span class="w"> </span><span class="kn">import</span> <span class="n">Acid</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">oxalic_acid</span> <span class="o">=</span> <span class="n">Acid</span><span class="p">([</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">4.14</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">HOx_species</span> <span class="o">=</span> <span class="n">oxalic_acid</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pypH&#39;
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Species</span></code> object can be summed to and subtracted from other <code class="docutils literal notranslate"><span class="pre">Species</span></code> and <code class="docutils literal notranslate"><span class="pre">Auxiliary</span></code> object leading to an <code class="docutils literal notranslate"><span class="pre">Auxiliary</span></code> object representing a symbolic algebric expression. As an example if we want to construct the expression <span class="math notranslate nohighlight">\([HOx^-] + 2[Ox^{2-}]\)</span> we can operate as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pypH.acid</span><span class="w"> </span><span class="kn">import</span> <span class="n">Acid</span>

<span class="n">oxalic_acid</span> <span class="o">=</span> <span class="n">Acid</span><span class="p">([</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">4.14</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">oxalic_acid</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">oxalic_acid</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">expression</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">b</span>

<span class="nb">print</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-an-auxiliary-expression">
<h2>Plotting an <code class="docutils literal notranslate"><span class="pre">Auxiliary</span></code> expression<a class="headerlink" href="#plotting-an-auxiliary-expression" title="Link to this heading"></a></h2>
<p>Now that we have shown how algebric expression can be created in the <code class="docutils literal notranslate"><span class="pre">pypH</span></code> environment, we can now show how these expressions can be plotted onto a logarithmic diagram. To demonstrate how this can be done, let us consider a practical example: the problem of computing the <span class="math notranslate nohighlight">\(pH\)</span> of a <span class="math notranslate nohighlight">\(0.01M\)</span> diammonium phosphate <span class="math notranslate nohighlight">\((NH_4)_2HPO_4\)</span> solution. To do so, let us start by defining the system of acids according to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pypH.acid</span><span class="w"> </span><span class="kn">import</span> <span class="n">Acid</span>

<span class="n">phosphoric_acid</span> <span class="o">=</span> <span class="n">Acid</span><span class="p">([</span><span class="mf">2.14</span><span class="p">,</span> <span class="mf">7.20</span><span class="p">,</span> <span class="mf">12.37</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;$H_3PO_4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$H_2PO_4^-$&quot;</span><span class="p">,</span> <span class="s2">&quot;$HPO_4^{2-}$&quot;</span><span class="p">,</span> <span class="s2">&quot;$PO_4^{3-}$&quot;</span><span class="p">])</span>
<span class="n">ammonium</span> <span class="o">=</span> <span class="n">Acid</span><span class="p">([</span><span class="mf">9.24</span><span class="p">],</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;$NH_4^+$&quot;</span><span class="p">,</span> <span class="s2">&quot;$NH_3$&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>To solve the problem and compute the <span class="math notranslate nohighlight">\(pH\)</span> of the solution, one should consider the protonic balance that, for the system in question is represented by:</p>
<div class="math notranslate nohighlight">
\[
    [H_3O^+] + [H_2PO_4^-] + 2[H_3PO_4] = [PO_4^{3-}] + [NH_3] + [OH^-]
\]</div>
<p>To visualze the protonic balance on the logarithmic diagram one should represents both sides of the equality in terms of an <code class="docutils literal notranslate"><span class="pre">Auxiliary</span></code> function object. This can be done easily by adopting what discussed in the previous paragraph.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pypH.acid</span><span class="w"> </span><span class="kn">import</span> <span class="n">Hydronium</span><span class="p">,</span> <span class="n">Hydroxide</span>

<span class="n">right_side</span> <span class="o">=</span> <span class="n">phosphoric_acid</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">ammonium</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hydroxide</span>
<span class="n">left_side</span> <span class="o">=</span> <span class="n">Hydronium</span> <span class="o">+</span> <span class="n">phosphoric_acid</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">phosphoric_acid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">right_side</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">left_side</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Where the <code class="docutils literal notranslate"><span class="pre">Hydronium</span></code> and <code class="docutils literal notranslate"><span class="pre">Hydroxide</span></code> object are pre-defined intances of the <code class="docutils literal notranslate"><span class="pre">AcidSpecies</span></code> class to represent the solvent derived ions <span class="math notranslate nohighlight">\(H_3O^+\)</span> ad <span class="math notranslate nohighlight">\(OH^-\)</span>.</p>
<p>The auxiliary curves can now be added to the plot using the <code class="docutils literal notranslate"><span class="pre">add_auxiliary</span></code> function according to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pypH.system</span><span class="w"> </span><span class="kn">import</span> <span class="n">System</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="p">()</span>

<span class="n">system</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">phosphoric_acid</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ammonium</span><span class="p">)</span>

<span class="n">system</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">right_side</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;r.h.s&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">left_side</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;l.h.s&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">system</span><span class="o">.</span><span class="n">plot_logarithmic_diagram</span><span class="p">(</span><span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">concentration_range</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>As can be seen the protonic balance is satisfied at <span class="math notranslate nohighlight">\(pH \approx 8.05\)</span>.</p>
</section>
<section id="solving-an-auxiliary-expression">
<h2>Solving an auxiliary expression<a class="headerlink" href="#solving-an-auxiliary-expression" title="Link to this heading"></a></h2>
<p>In what we have shown previously the <span class="math notranslate nohighlight">\(pH\)</span> of a <span class="math notranslate nohighlight">\(0.01M\)</span> diammonium phosphate <span class="math notranslate nohighlight">\((NH_4)_2HPO_4\)</span> solution was deducted graphically by looking at the logarithmic diagram. The <code class="docutils literal notranslate"><span class="pre">pypH</span></code> library however allows also the computation of numerical solutions to the problem. To do so, the protonic balance of the system can be passed to the <code class="docutils literal notranslate"><span class="pre">solve</span></code> method of the <code class="docutils literal notranslate"><span class="pre">System</span></code> class. This function will numerically evaluate the zeros of the expression by means of the dicotomic method. The <span class="math notranslate nohighlight">\(pH\)</span> of the solution can, as such, be comuted according to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">computed_pH</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">left_side</span><span class="p">,</span> <span class="n">right_side</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The pH of the solution is </span><span class="si">{</span><span class="n">computed_pH</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Very close to the value estimated before by graphical inspection.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Guide"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>